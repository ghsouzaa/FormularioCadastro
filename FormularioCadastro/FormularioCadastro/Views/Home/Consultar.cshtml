@model FormularioCadastro.Models.ConsultarViewModel
<html>
<head>
    <link rel="stylesheet" type="text/css" href="~/Content/bootstrap.min.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultar</title>

    <style>
        body {
            padding-top: 50px;
            background-color: #eef3f9;
        }

        #containerFormulario {
            padding: 30px;
            background-color: white;
            box-shadow: 0px 0px 10px rgba(128, 128, 128, 0.40);
            border-radius: .3rem;
        }

        @@media screen and ( max-width: 767px) {
            .formulario {
                width: 80%;
            }
        }
    </style>
</head>
<body>
    <div id="containerFormulario" class="container">
        <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="#">Navbar</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/Home/Index">Cadastrar</a>
                    </li>
                    <li class="nav-item active  ">
                        <a class="nav-link" href="/Home/Consultar">Consultar<span class="sr-only">(current)</span></a>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="row">
            <div class="col">
                <h3 style="text-align:center">Consultar Pessoas</h3>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Nome</th>
                                <th scope="col">CPF</th>
                                <th scope="col">Data de nascimento</th>
                                <th scope="col">Celular</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.pessoas)
                            {
                                <tr id="tr_@item.IDPessoa">
                                    <th scope="row">@item.IDPessoa</th>
                                    <td>@item.Nome</td>
                                    <td>@item.CPF</td>
                                    <td>@item.DataNascimento.ToString("dd/MM/yyyy")</td>
                                    <td>@item.Celular</td>
                                    <td>
                                        <button onclick="ExcluirPessoa(@item.IDPessoa)" type="button" class="btn btn-sm btn-danger btn-block">Excluir</button>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="~/Scripts/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@1.5.4/src/loadingoverlay.min.js"></script>
    <script>
        function ExcluirPessoa(idPessoa) {
            $.LoadingOverlay("show");

            var url = '@Url.Action("ExcluirPessoa", "Home")' + "?idPessoa=" + idPessoa;

            var result = $.getJSON(url, function () {
            }).done(function (response) {
                var message;
                if (response.Success) {
                    message = response.Message + " excluido(a) com sucesso!";
                }
                else {
                    message = "Erro ao tentar excluir pessoa. Erro: " + response.Message;
                }
                alert(message);
                window.location.href = '@Url.Action("Consultar", "Home")';
            }).always(function () {
                $.LoadingOverlay("hide");
            });
        }
    </script>
</body>
</html>